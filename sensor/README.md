# Sensor Service

> i-room í”„ë¡œì íŠ¸ì˜ ì„¼ì„œ ë°ì´í„° ë° ìœ„ì¹˜ ì¶”ì  ì„œë¹„ìŠ¤

> ëª©ì°¨
> - [ğŸ“„ ì„œë¹„ìŠ¤ ì†Œê°œ](#ì„œë¹„ìŠ¤-ì†Œê°œ)
> - [ğŸ§‘â€ğŸ’» ê°œë°œì](#ê°œë°œì)
> - [ğŸ’» ì„œë¹„ìŠ¤ ê°œë°œ ì£¼ì•ˆì ](#ì„œë¹„ìŠ¤-ê°œë°œ-ì£¼ì•ˆì )
> - [ğŸš€ ì‹œì‘ ê°€ì´ë“œ](#ì‹œì‘-ê°€ì´ë“œ)
> - [âš™ï¸ ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
> - [ğŸ—ï¸ ì•„í‚¤í…ì²˜](#ì•„í‚¤í…ì²˜)
> - [ğŸ“‹ ì£¼ìš” ê¸°ëŠ¥](#ì£¼ìš”-ê¸°ëŠ¥)
> - [ğŸŒ í™˜ê²½ë³„ ì„¤ì •](#í™˜ê²½ë³„-ì„¤ì •)
> - [ğŸ“¡ API ëª…ì„¸](#api-ëª…ì„¸)

<a id="ì„œë¹„ìŠ¤-ì†Œê°œ"></a>

## ğŸ“„ ì„œë¹„ìŠ¤ ì†Œê°œ

i-room ì„œë¹„ìŠ¤ì˜ ê·¼ë¡œì ì„¼ì„œ ë°ì´í„°ì™€ ì¤‘ì¥ë¹„ ìœ„ì¹˜ ì¶”ì ì„ ë‹´ë‹¹í•˜ëŠ” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ì›¨ì–´ëŸ¬ë¸” ë””ë°”ì´ìŠ¤ì˜ ë°”ì´ë„ˆë¦¬ ë°ì´í„° ì²˜ë¦¬ì™€ WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ìœ„ì¹˜ ì •ë³´ ì „ì†¡ì„ ì§€ì›í•©ë‹ˆë‹¤.

### í•µì‹¬ ê¸°ëŠ¥

- **ê·¼ë¡œì ì„¼ì„œ ë°ì´í„°**: ì›¨ì–´ëŸ¬ë¸” ë””ë°”ì´ìŠ¤ì˜ ìƒì²´ ë° ìœ„ì¹˜ ì •ë³´ ì²˜ë¦¬
- **ì¤‘ì¥ë¹„ ê´€ë¦¬**: ê±´ì„¤ í˜„ì¥ ì¤‘ì¥ë¹„ ë“±ë¡ ë° ìœ„ì¹˜ ì¶”ì 
- **ì‹¤ì‹œê°„ ì „ì†¡**: WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ìœ„ì¹˜ ë°ì´í„° ì „ì†¡
- **ì´ë²¤íŠ¸ ì²˜ë¦¬**: Kafkaë¥¼ í†µí•œ ìœ„ì¹˜ ë° ì„¼ì„œ ì´ë²¤íŠ¸ ë°œí–‰

<a id="ê°œë°œì"></a>

## ğŸ§‘â€ğŸ’» ê°œë°œì

|             | ì´ì„±í›ˆ                                                      | ì¡°ìŠ¹ë¹ˆ                                                         | ë°•ì†Œì—°                                                     |
|-------------|----------------------------------------------------------|-------------------------------------------------------------|---------------------------------------------------------|
| **E-Mail**  | p.plue1881@gmail.com                                     | benscience@naver.com                                        | gumza9go@gmail.com                                      |
| **GitHub**  | [NextrPlue](https://github.com/NextrPlue)                | [changeme4585](https://github.com/changeme4585)             | [sorasol9](https://github.com/sorasol9)                 |
| **Profile** | <img src="https://github.com/NextrPlue.png" width=100px> | <img src="https://github.com/changeme4585.png" width=100px> | <img src="https://github.com/sorasol9.png" width=100px> |

<a id="ì„œë¹„ìŠ¤-ê°œë°œ-ì£¼ì•ˆì "></a>

## ğŸ’» ì„œë¹„ìŠ¤ ê°œë°œ ì£¼ì•ˆì 

### ğŸ“Œ ë°”ì´ë„ˆë¦¬ ë°ì´í„° ì²˜ë¦¬ ë° ì‹¤ì‹œê°„ í†µì‹ 

> ì›¨ì–´ëŸ¬ë¸” ë””ë°”ì´ìŠ¤ì—ì„œ ì „ì†¡ë˜ëŠ” ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³ , WebSocketì„ í†µí•´ ì‹¤ì‹œê°„ìœ¼ë¡œ ìœ„ì¹˜ ì •ë³´ë¥¼ ì „ì†¡í•˜ëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í–ˆìŠµë‹ˆë‹¤. GPS í•„í„°ë§ê³¼ Kafka ì´ë²¤íŠ¸ ë°œí–‰ì„ í†µí•´ ì •í™•í•˜ê³  ì‹ ë¢°ì„± ìˆëŠ” ìœ„ì¹˜
> ì¶”ì  ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

<a id="ì‹œì‘-ê°€ì´ë“œ"></a>

## ğŸš€ ì‹œì‘ ê°€ì´ë“œ

### ì‚¬ì „ ì¤€ë¹„ ì‚¬í•­

- Java 17
- Gradle 8.14 ì´ìƒ

### ì„œë¹„ìŠ¤ ì‹¤í–‰

1. **í”„ë¡œì íŠ¸ í´ë¡  ë° ë””ë ‰í† ë¦¬ ì´ë™**
   ```bash
   git clone {ì €ì¥ì†Œ URL}
   cd i-room/sensor
   ```

2. **Gradleì„ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰**
   ```bash
   ./gradlew bootRun
   ```
   *Windowsì˜ ê²½ìš°:*
   ```bash
   gradlew.bat bootRun
   ```

3. **ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •** (í•„ìˆ˜)
   MySQL ë°ì´í„°ë² ì´ìŠ¤ê°€ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•˜ë©°, `iroom_sensor` ë°ì´í„°ë² ì´ìŠ¤ê°€ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
   ```sql
   CREATE DATABASE iroom_sensor;
   ```

4. **Kafka ì„¤ì •** (í•„ìˆ˜)
   ë¡œì»¬ í™˜ê²½ì—ì„œ Kafkaê°€ `localhost:9092`ì—ì„œ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

5. **ì• í”Œë¦¬ì¼€ì´ì…˜ ì ‘ì†**
   ì„œë¹„ìŠ¤ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ë©´ `http://localhost:8083`ì—ì„œ ì„œë¹„ìŠ¤ê°€ í™œì„±í™”ë˜ê³ , WebSocket ì—”ë“œí¬ì¸íŠ¸ë¥¼ í†µí•´ ì‹¤ì‹œê°„ ìœ„ì¹˜ ë°ì´í„°ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<a id="ê¸°ìˆ -ìŠ¤íƒ"></a>

## âš™ï¸ ê¸°ìˆ  ìŠ¤íƒ

- **Java 17**: í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **Spring Boot 3.5.3**: ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬
- **Spring WebSocket**: WebSocket ë° STOMP í”„ë¡œí† ì½œ ì§€ì›
- **Spring Data JPA**: ë°ì´í„°ë² ì´ìŠ¤ ORM
- **Spring Cloud 2025.0.0**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì¸í”„ë¼
- **Spring Cloud Stream**: Kafka ë©”ì‹œì§•
- **MySQL 8.0**: ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤
- **Apache Kafka**: ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°
- **Gradle**: ë¹Œë“œ ë„êµ¬
- **Micrometer**: ë©”íŠ¸ë¦­ ë° ì¶”ì 

<a id="ì•„í‚¤í…ì²˜"></a>

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Gateway     â”‚    â”‚  Sensor Service â”‚    â”‚    MySQL DB     â”‚
â”‚                 â”‚â—„â”€â”€â–ºâ”‚                 â”‚â—„â”€â”€â–ºâ”‚   (iroom_sensor)â”‚
â”‚  - JWT Auth     â”‚    â”‚  - WebSocket    â”‚    â”‚                 â”‚
â”‚  - Routing      â”‚    â”‚  - Equipment    â”‚    â”‚ - worker_sensor â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  - Worker Data  â”‚    â”‚ - heavy_equip   â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ - worker_read   â”‚
                             â–²  â–²             â”‚   _model        â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–¼                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Wearable Device â”‚    â”‚   Kafka Broker  â”‚    â”‚   WebSocket Clients   â”‚
â”‚                 â”‚    â”‚                 â”‚â—„â”€â”€â–ºâ”‚  - Admin Dashboard    â”‚
â”‚  - Binary Data  â”‚    â”‚  Topic: iroom   â”‚    â”‚  - Worker Page        â”‚
â”‚  - GPS/Health   â”‚    â”‚ - WorkerSensor  â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ - EquipmentLoc  â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â–²
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Other Services     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

<a id="ì£¼ìš”-ê¸°ëŠ¥"></a>

## ğŸ“‹ ì£¼ìš” ê¸°ëŠ¥

### 1. ê·¼ë¡œì ì„¼ì„œ ë°ì´í„° (`/worker-sensor/**`)

- **ì„¼ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸**: `PUT /worker-sensor/update` (ë°”ì´ë„ˆë¦¬ ë°ì´í„°)
- **ìœ„ì¹˜ ì¡°íšŒ**: `GET /worker-sensor/location/{workerId}`
- **ì „ì²´ ìœ„ì¹˜ ì¡°íšŒ**: `GET /worker-sensor/locations` (ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§)

### 2. ì¤‘ì¥ë¹„ ê´€ë¦¬ (`/heavy-equipments/**`)

- **ì¤‘ì¥ë¹„ ë“±ë¡**: `POST /heavy-equipments/register`
- **ìœ„ì¹˜ ì—…ë°ì´íŠ¸**: `PUT /heavy-equipments/location` (ë°”ì´ë„ˆë¦¬ ë°ì´í„°)
- **ì¤‘ì¥ë¹„ ì¡°íšŒ**: `GET /heavy-equipments/{equipmentId}`
- **ì „ì²´ ì¤‘ì¥ë¹„ ì¡°íšŒ**: `GET /heavy-equipments`

### 3. WebSocket ì‹¤ì‹œê°„ ì „ì†¡

- **WebSocket ì—”ë“œí¬ì¸íŠ¸**: `/sensor/ws`
- **ìœ„ì¹˜ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°**: ì‹¤ì‹œê°„ ê·¼ë¡œì ë° ì¤‘ì¥ë¹„ ìœ„ì¹˜ ì „ì†¡
- **STOMP í”„ë¡œí† ì½œ**: `/topic/locations/{workerId}` êµ¬ë…

<a id="í™˜ê²½ë³„-ì„¤ì •"></a>

## ğŸŒ í™˜ê²½ë³„ ì„¤ì •

### ë¡œì»¬ ê°œë°œ í™˜ê²½ (ê¸°ë³¸)

- **Database**: `localhost:3306/iroom_sensor`
- **Kafka**: `localhost:9092`

### Docker í™˜ê²½ (`docker` í”„ë¡œí•„)

- **Database**: `mysql:3306/iroom_sensor`
- **Kafka**: `kafka:9093`

### Kubernetes í™˜ê²½ (`k8s` í”„ë¡œí•„)

- **Database**: `i-room-mysql/iroom_sensor`
- **Kafka**: `i-room-kafka:9092`

<a id="api-ëª…ì„¸"></a>

## ğŸ“¡ API ëª…ì„¸

ì„¼ì„œ ì„œë¹„ìŠ¤ëŠ” RESTful APIì™€ WebSocketì„ í†µí•´ í†µì‹ í•˜ë©°, ë°”ì´ë„ˆë¦¬ ë°ì´í„° ì²˜ë¦¬ë¥¼ ì§€ì›í•©ë‹ˆë‹¤. ìì„¸í•œ API ëª…ì„¸ëŠ” ì•„ë˜ Notion ë§í¬ì˜ 'Sensor' ì„¹ì…˜ì„ ì°¸ê³ í•˜ì‹­ì‹œì˜¤.

- [i-room API ëª…ì„¸ì„œ (Notion)](https://disco-mitten-e75.notion.site/API-238f6cd45c7380209227f1f66bddebdd?pvs=73)